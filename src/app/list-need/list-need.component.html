<div>
  <ng-container *ngIf="{ categories: (categories$ | async), categorizedItems: (itemsCatagorizedFiltered$ | async) } as results">
    <mat-accordion class="categories">
      <ng-container *ngFor="let category of results.categories">
        <ng-container *ngIf="!!results.categorizedItems">
          <mat-expansion-panel class="category" *ngIf="results.categorizedItems[category] as items">
            <mat-expansion-panel-header>
              <mat-panel-title>{{category}}</mat-panel-title>
              <mat-panel-description>{{items?.length || 0}}</mat-panel-description>
            </mat-expansion-panel-header>
            <ng-template matExpansionPanelContent>
              <ul class="items">
                <li
                  class="item"
                  *ngFor="let item of (items || []); trackBy: trackByItemID"
                  tabindex="0"
                >
                  <app-list-item [item]="item">
                    <button mat-icon-button
                      (click)="moveToCart(item)"
                      color="accent"
                      type="button"
                      matTooltip="Move item to shopping cart"
                      aria-label="Moves item to shopping cart for bulk toogle of item's obtained state"
                    ><mat-icon svgIcon="checkbox-empty"></mat-icon></button>
                  </app-list-item>
                </li>
              </ul>
            </ng-template>
          </mat-expansion-panel>
        </ng-container>
      </ng-container>
    </mat-accordion>
  </ng-container>
</div>
<app-new-item [obtained]="false"></app-new-item>
<div *ngIf="(cartItemsFiltered$ | async) as items" class="basket">
  <mat-expansion-panel *ngIf="!!items?.length">
    <mat-expansion-panel-header>
      <mat-panel-title>Shopping Cart</mat-panel-title>
      <mat-panel-description>{{items?.length || 0}}</mat-panel-description>
    </mat-expansion-panel-header>
    <ng-template matExpansionPanelContent>
      <ul class="items">
        <li
          class="item"
          *ngFor="let item of items; trackBy: trackByItemID"
          tabindex="0"
        >
          <app-list-item [item]="item">
            <button mat-icon-button
              color="accent"
              (click)="removeFromCart(item)"
              type="button"
              matTooltip="Remove item from shopping cart"
            ><mat-icon svgIcon="checkbox-filled"></mat-icon></button>
          </app-list-item>
        </li>
      </ul>
      <div class="cart-actions">
        <button mat-raised-button
          class="clear"
          type="button"
          (click)="clearCart()"
          matTooltip="Clear shopping cart, moving items to main list"
        >Clear</button>
        <button mat-raised-button
          class="checkout"
          color="accent"
          type="button"
          (click)="checkout()"
          matTooltip="Checkout all cart items moving them to the 'have' list"
        >Checkout</button>
      </div>
    </ng-template>
  </mat-expansion-panel>
</div>
